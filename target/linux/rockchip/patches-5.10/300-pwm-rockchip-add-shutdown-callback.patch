From fbd0a3abe52001383ab5d80a9c787c29561dd741 Mon Sep 17 00:00:00 2001
From: hmz007 <hmz007@gmail.com>
Date: Thu, 20 Feb 2020 18:28:31 +0800
Subject: [PATCH 1/3] pwm: rockchip: add shutdown callback

Signed-off-by: hmz007 <hmz007@gmail.com>
---
 drivers/pwm/pwm-rockchip.c | 7 +++++++
 1 file changed, 7 insertions(+)

diff --git a/drivers/pwm/pwm-rockchip.c b/drivers/pwm/pwm-rockchip.c
index 77c23a2c6d71..d73400b7e7f4 100644
--- a/drivers/pwm/pwm-rockchip.c
+++ b/drivers/pwm/pwm-rockchip.c
@@ -11,6 +11,7 @@
 #include <linux/module.h>
 #include <linux/of.h>
 #include <linux/of_device.h>
+#include <linux/pinctrl/consumer.h>
 #include <linux/platform_device.h>
 #include <linux/pwm.h>
 #include <linux/time.h>
@@ -398,6 +399,11 @@ static int rockchip_pwm_remove(struct platform_device *pdev)
 	return pwmchip_remove(&pc->chip);
 }
 
+static void rockchip_pwm_shutdown(struct platform_device *pdev)
+{
+	pinctrl_pm_select_sleep_state(&pdev->dev);
+}
+
 static struct platform_driver rockchip_pwm_driver = {
 	.driver = {
 		.name = "rockchip-pwm",
@@ -405,6 +411,7 @@ static struct platform_driver rockchip_pwm_driver = {
 	},
 	.probe = rockchip_pwm_probe,
 	.remove = rockchip_pwm_remove,
+	.shutdown = rockchip_pwm_shutdown,
 };
 module_platform_driver(rockchip_pwm_driver);
 
-- 
2.29.1

